# CG-CEL 计算验证 (LaTeX 格式)

## 算法说明

CG-CEL (Contested Garment CEL) 算法分两个阶段:

**规则:**
- 设总财产为 $E$，索赔向量为 $c = (c_1, c_2, ..., c_n)$
- 令 $S = \sum_{i=1}^{n} c_i$ (总索赔)

**情况1:** 如果 $E \leq \frac{S}{2}$，则使用 **CEA** (Constrained Equal Awards) 分配在 $\frac{c_i}{2}$ 上:
- 找到 $\lambda$ 使得 $\sum_{i=1}^{n} \min(\frac{c_i}{2}, \lambda) = E$
- 分配: $x_i = \min(\frac{c_i}{2}, \lambda)$

**情况2:** 如果 $E > \frac{S}{2}$，则:
- 第一步: 每人先获得 $\frac{c_i}{2}$
- 第二步: 剩余 $E - \frac{S}{2}$ 用 **CEL** (Constrained Equal Losses) 分配在 $\frac{c_i}{2}$ 上
- CEL: 找到 $\mu$ 使得 $\sum_{i=1}^{n} \max(0, \frac{c_i}{2} - \mu) = E - \frac{S}{2}$
- 最终分配: $x_i = \frac{c_i}{2} + \max(0, \frac{c_i}{2} - \mu)$

---

## E=55 的情况验证

### 1. Claims=[25, 25, 25, 25], E=55

$$S = 25 + 25 + 25 + 25 = 100$$
$$\frac{S}{2} = 50$$
$$E = 55 > 50$$

使用情况2:
- 每人先得: $\frac{25}{2} = 12.5$
- 总共先分配: $4 \times 12.5 = 50$
- 剩余: $55 - 50 = 5$

CEL阶段: 在 $(\frac{25}{2}, \frac{25}{2}, \frac{25}{2}, \frac{25}{2}) = (12.5, 12.5, 12.5, 12.5)$ 上分配5
- 找 $\mu$ 使得 $\sum \max(0, 12.5 - \mu) = 5$
- $4(12.5 - \mu) = 5$
- $50 - 4\mu = 5$
- $\mu = 11.25$

最终分配:
$$x_i = 12.5 + (12.5 - 11.25) = 12.5 + 1.25 = 13.75$$

**结果:** $[13.75, 13.75, 13.75, 13.75]$ ✓

---

### 2. Claims=[30, 30, 20, 20], E=55

$$S = 30 + 30 + 20 + 20 = 100, \quad \frac{S}{2} = 50$$
$$E = 55 > 50$$

- 先分配: $(15, 15, 10, 10)$，总共50
- 剩余: 5

CEL在 $(15, 15, 10, 10)$ 上分配5:
- 找 $\mu$ 使得 $\sum \max(0, \frac{c_i}{2} - \mu) = 5$
- 试 $\mu = 10$: $\max(0, 15-10) + \max(0, 15-10) + \max(0, 10-10) + \max(0, 10-10) = 5 + 5 + 0 + 0 = 10$ (太大)
- 试 $\mu = 12.5$: $\max(0, 15-12.5) + \max(0, 15-12.5) + 0 + 0 = 2.5 + 2.5 = 5$ ✓

最终:
$$x_1 = 15 + (15 - 12.5) = 17.5$$
$$x_2 = 15 + (15 - 12.5) = 17.5$$
$$x_3 = 10 + (10 - 12.5) = 10 + 0 = 10$$
$$x_4 = 10 + 0 = 10$$

**结果:** $[17.5, 17.5, 10, 10]$ ✓

---

### 3. Claims=[40, 20, 20, 20], E=55

$$S = 40 + 20 + 20 + 20 = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(20, 10, 10, 10)$，总共50
- 剩余: 5

CEL在 $(20, 10, 10, 10)$ 上分配5:
- 找 $\mu$ 使得 $\max(0, 20-\mu) + 3\max(0, 10-\mu) = 5$
- 试 $\mu = 15$: $(20-15) + 0 = 5$ ✓

最终:
$$x_1 = 20 + (20 - 15) = 25$$
$$x_2 = x_3 = x_4 = 10 + 0 = 10$$

**结果:** $[25, 10, 10, 10]$ ✓

---

### 4. Claims=[50, 20, 15, 15], E=55

$$S = 50 + 20 + 15 + 15 = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(25, 10, 7.5, 7.5)$，总共50
- 剩余: 5

CEL在 $(25, 10, 7.5, 7.5)$ 上分配5:
- 找 $\mu$ 使得 $\max(0, 25-\mu) + \max(0, 10-\mu) + 2\max(0, 7.5-\mu) = 5$
- 试 $\mu = 20$: $(25-20) + 0 + 0 = 5$ ✓

最终:
$$x_1 = 25 + (25 - 20) = 30$$
$$x_2 = 10 + 0 = 10$$
$$x_3 = x_4 = 7.5 + 0 = 7.5$$

**结果:** $[30, 10, 7.5, 7.5]$ ✓

---

### 5. Claims=[10, 30, 30, 30], E=55

$$S = 10 + 30 + 30 + 30 = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(5, 15, 15, 15)$，总共50
- 剩余: 5

CEL在 $(5, 15, 15, 15)$ 上分配5:
- 找 $\mu$ 使得 $\max(0, 5-\mu) + 3\max(0, 15-\mu) = 5$
- 试 $\mu = 13.333...$: $0 + 3(15 - 13.333...) = 3 \times 1.666... = 5$ ✓
- $\mu = 15 - \frac{5}{3} = \frac{40}{3}$

最终:
$$x_1 = 5 + 0 = 5$$
$$x_2 = x_3 = x_4 = 15 + (15 - \frac{40}{3}) = 15 + \frac{5}{3} = \frac{50}{3} \approx 16.6667$$

**结果:** $[5, 16.67, 16.67, 16.67]$ ✓

---

### 6. Claims=[15, 35, 25, 25], E=55

$$S = 15 + 35 + 25 + 25 = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(7.5, 17.5, 12.5, 12.5)$，总共50
- 剩余: 5

CEL在 $(7.5, 17.5, 12.5, 12.5)$ 上分配5:
- 找 $\mu$ 使得 $\max(0, 7.5-\mu) + \max(0, 17.5-\mu) + 2\max(0, 12.5-\mu) = 5$
- 试 $\mu = 12.5$: $0 + (17.5 - 12.5) + 0 = 5$ ✓

最终:
$$x_1 = 7.5 + 0 = 7.5$$
$$x_2 = 17.5 + 5 = 22.5$$
$$x_3 = x_4 = 12.5 + 0 = 12.5$$

**结果:** $[7.5, 22.5, 12.5, 12.5]$ ✓

---

### 7. Claims=[60, 15, 15, 10], E=55

$$S = 60 + 15 + 15 + 10 = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(30, 7.5, 7.5, 5)$，总共50
- 剩余: 5

CEL在 $(30, 7.5, 7.5, 5)$ 上分配5:
- 找 $\mu$ 使得 $\max(0, 30-\mu) + 2\max(0, 7.5-\mu) + \max(0, 5-\mu) = 5$
- 试 $\mu = 25$: $(30-25) + 0 + 0 = 5$ ✓

最终:
$$x_1 = 30 + 5 = 35$$
$$x_2 = x_3 = 7.5 + 0 = 7.5$$
$$x_4 = 5 + 0 = 5$$

**结果:** $[35, 7.5, 7.5, 5]$ ✓

---

### 8. Claims=[70, 10, 10, 10], E=55

$$S = 70 + 10 + 10 + 10 = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(35, 5, 5, 5)$，总共50
- 剩余: 5

CEL在 $(35, 5, 5, 5)$ 上分配5:
- 找 $\mu$ 使得 $\max(0, 35-\mu) + 3\max(0, 5-\mu) = 5$
- 试 $\mu = 30$: $(35-30) + 0 = 5$ ✓

最终:
$$x_1 = 35 + 5 = 40$$
$$x_2 = x_3 = x_4 = 5 + 0 = 5$$

**结果:** $[40, 5, 5, 5]$ ✓

---

## E=60 的情况验证

### 1. Claims=[25, 25, 25, 25], E=60

$$S = 100, \quad \frac{S}{2} = 50, \quad E = 60 > 50$$

- 先分配: $(12.5, 12.5, 12.5, 12.5)$，总共50
- 剩余: $60 - 50 = 10$

CEL在 $(12.5, 12.5, 12.5, 12.5)$ 上分配10:
- $4(12.5 - \mu) = 10$
- $50 - 4\mu = 10$
- $\mu = 10$

最终:
$$x_i = 12.5 + (12.5 - 10) = 12.5 + 2.5 = 15$$

**结果:** $[15, 15, 15, 15]$ ✓

---

### 2. Claims=[30, 30, 20, 20], E=60

$$S = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(15, 15, 10, 10)$，总共50
- 剩余: 10

CEL在 $(15, 15, 10, 10)$ 上分配10:
- 找 $\mu$ 使得 $2\max(0, 15-\mu) + 2\max(0, 10-\mu) = 10$
- 试 $\mu = 10$: $2(15-10) + 2(10-10) = 10 + 0 = 10$ ✓

最终:
$$x_1 = x_2 = 15 + (15 - 10) = 20$$
$$x_3 = x_4 = 10 + 0 = 10$$

**结果:** $[20, 20, 10, 10]$ ✓

---

### 3. Claims=[40, 20, 20, 20], E=60

- 先分配: $(20, 10, 10, 10)$，总共50
- 剩余: 10

CEL在 $(20, 10, 10, 10)$ 上分配10:
- 找 $\mu$ 使得 $\max(0, 20-\mu) + 3\max(0, 10-\mu) = 10$
- 试 $\mu = 10$: $(20-10) + 3 \times 0 = 10$ ✓

最终:
$$x_1 = 20 + 10 = 30$$
$$x_2 = x_3 = x_4 = 10$$

**结果:** $[30, 10, 10, 10]$ ✓

---

### 4. Claims=[50, 20, 15, 15], E=60

- 先分配: $(25, 10, 7.5, 7.5)$，总共50
- 剩余: 10

CEL在 $(25, 10, 7.5, 7.5)$ 上分配10:
- 找 $\mu$ 使得 $\max(0, 25-\mu) + \max(0, 10-\mu) + 2\max(0, 7.5-\mu) = 10$
- 试 $\mu = 15$: $(25-15) + 0 + 0 = 10$ ✓

最终:
$$x_1 = 25 + 10 = 35$$
$$x_2 = 10, \quad x_3 = x_4 = 7.5$$

**结果:** $[35, 10, 7.5, 7.5]$ ✓

---

### 5. Claims=[10, 30, 30, 30], E=60

- 先分配: $(5, 15, 15, 15)$，总共50
- 剩余: 10

CEL在 $(5, 15, 15, 15)$ 上分配10:
- $3(15 - \mu) = 10$
- $\mu = 15 - \frac{10}{3} = \frac{35}{3}$

最终:
$$x_1 = 5$$
$$x_2 = x_3 = x_4 = 15 + \frac{10}{3} = \frac{55}{3} \approx 18.3333$$

**结果:** $[5, 18.33, 18.33, 18.33]$ ✓

---

### 6. Claims=[15, 35, 25, 25], E=60

- 先分配: $(7.5, 17.5, 12.5, 12.5)$，总共50
- 剩余: 10

CEL在 $(7.5, 17.5, 12.5, 12.5)$ 上分配10:
- 找 $\mu$ 使得 $\max(0, 7.5-\mu) + \max(0, 17.5-\mu) + 2\max(0, 12.5-\mu) = 10$
- 试 $\mu = 10$: $0 + (17.5-10) + 2(12.5-10) = 7.5 + 5 = 12.5$ (太大)
- 试 $\mu = 11$: $0 + (17.5-11) + 2(12.5-11) = 6.5 + 3 = 9.5$ (接近)
- 解: $0 + (17.5 - \mu) + 2(12.5 - \mu) = 10$
  - $17.5 - \mu + 25 - 2\mu = 10$
  - $42.5 - 3\mu = 10$
  - $\mu = \frac{32.5}{3} \approx 10.8333$

最终:
$$x_1 = 7.5$$
$$x_2 = 17.5 + (17.5 - 10.8333) = 17.5 + 6.6667 = 24.1667$$
$$x_3 = x_4 = 12.5 + (12.5 - 10.8333) = 12.5 + 1.6667 = 14.1667$$

**结果:** $[7.5, 24.17, 14.17, 14.17]$ ✓

---

### 7. Claims=[60, 15, 15, 10], E=60

- 先分配: $(30, 7.5, 7.5, 5)$，总共50
- 剩余: 10

CEL在 $(30, 7.5, 7.5, 5)$ 上分配10:
- $\max(0, 30-\mu) = 10$
- $\mu = 20$

最终:
$$x_1 = 30 + 10 = 40$$
$$x_2 = x_3 = 7.5, \quad x_4 = 5$$

**结果:** $[40, 7.5, 7.5, 5]$ ✓

---

### 8. Claims=[70, 10, 10, 10], E=60

- 先分配: $(35, 5, 5, 5)$，总共50
- 剩余: 10

CEL在 $(35, 5, 5, 5)$ 上分配10:
- $\max(0, 35-\mu) = 10$
- $\mu = 25$

最终:
$$x_1 = 35 + 10 = 45$$
$$x_2 = x_3 = x_4 = 5$$

**结果:** $[45, 5, 5, 5]$ ✓

---

## E=65 的情况验证

### 1. Claims=[25, 25, 25, 25], E=65

- 先分配: 50
- 剩余: 15

CEL在 $(12.5, 12.5, 12.5, 12.5)$ 上分配15:
- $4(12.5 - \mu) = 15$
- $\mu = 8.75$

最终:
$$x_i = 12.5 + 3.75 = 16.25$$

**结果:** $[16.25, 16.25, 16.25, 16.25]$ ✓

---

### 2. Claims=[30, 30, 20, 20], E=65

- 先分配: $(15, 15, 10, 10)$
- 剩余: 15

CEL:
- $2(15-\mu) + 2(10-\mu) = 15$
- 试 $\mu = 7.5$: $2(7.5) + 2(2.5) = 15 + 5 = 20$ (太大)
- $2(15-\mu) + 2(10-\mu) = 15$
- $30 - 2\mu + 20 - 2\mu = 15$
- $50 - 4\mu = 15$
- $\mu = 8.75$

最终:
$$x_1 = x_2 = 15 + (15 - 8.75) = 21.25$$
$$x_3 = x_4 = 10 + (10 - 8.75) = 11.25$$

**结果:** $[21.25, 21.25, 11.25, 11.25]$ ✓

---

### 3. Claims=[40, 20, 20, 20], E=65

- 先分配: $(20, 10, 10, 10)$
- 剩余: 15

CEL:
- $(20-\mu) + 3(10-\mu) = 15$
- $20 - \mu + 30 - 3\mu = 15$
- $50 - 4\mu = 15$
- $\mu = 8.75$

最终:
$$x_1 = 20 + 11.25 = 31.25$$
$$x_2 = x_3 = x_4 = 10 + 1.25 = 11.25$$

**结果:** $[31.25, 11.25, 11.25, 11.25]$ ✓

---

### 4. Claims=[50, 20, 15, 15], E=65

- 先分配: $(25, 10, 7.5, 7.5)$
- 剩余: 15

CEL:
- $(25-\mu) + (10-\mu) + 2(7.5-\mu) = 15$
- $25 - \mu + 10 - \mu + 15 - 2\mu = 15$
- $50 - 4\mu = 15$
- $\mu = 8.75$

检查: $\mu = 8.75 < 7.5$? 不是，所以 $7.5 - 8.75 < 0$

重新考虑:
- 找 $\mu$ 使得 $(25-\mu) + (10-\mu) + 2\max(0, 7.5-\mu) = 15$
- 试 $\mu = 10$: $(25-10) + 0 + 0 = 15$ ✓

最终:
$$x_1 = 25 + 15 = 40$$
$$x_2 = x_3 = x_4 = 10 + 0 = 10, \quad 7.5 + 0 = 7.5$$

**结果:** $[40, 10, 7.5, 7.5]$ ✓

---

### 5. Claims=[10, 30, 30, 30], E=65

- 先分配: $(5, 15, 15, 15)$
- 剩余: 15

CEL:
- $3(15 - \mu) = 15$
- $\mu = 10$

最终:
$$x_1 = 5$$
$$x_2 = x_3 = x_4 = 15 + 5 = 20$$

**结果:** $[5, 20, 20, 20]$ ✓

---

### 6. Claims=[15, 35, 25, 25], E=65

- 先分配: $(7.5, 17.5, 12.5, 12.5)$
- 剩余: 15

CEL:
- $(17.5-\mu) + 2(12.5-\mu) = 15$
- $17.5 - \mu + 25 - 2\mu = 15$
- $42.5 - 3\mu = 15$
- $\mu = \frac{27.5}{3} \approx 9.1667$

最终:
$$x_1 = 7.5$$
$$x_2 = 17.5 + (17.5 - 9.1667) = 17.5 + 8.3333 = 25.8333$$
$$x_3 = x_4 = 12.5 + (12.5 - 9.1667) = 12.5 + 3.3333 = 15.8333$$

**结果:** $[7.5, 25.83, 15.83, 15.83]$ ✓

---

### 7. Claims=[60, 15, 15, 10], E=65

- 先分配: $(30, 7.5, 7.5, 5)$
- 剩余: 15

CEL:
- $(30-\mu) = 15$
- $\mu = 15$

最终:
$$x_1 = 30 + 15 = 45$$
$$x_2 = x_3 = 7.5, \quad x_4 = 5$$

**结果:** $[45, 7.5, 7.5, 5]$ ✓

---

### 8. Claims=[70, 10, 10, 10], E=65

- 先分配: $(35, 5, 5, 5)$
- 剩余: 15

CEL:
- $(35-\mu) = 15$
- $\mu = 20$

最终:
$$x_1 = 35 + 15 = 50$$
$$x_2 = x_3 = x_4 = 5$$

**结果:** $[50, 5, 5, 5]$ ✓

---

## 极端情况验证

### E=55, Claims=[90, 5, 3, 2]

$$S = 90 + 5 + 3 + 2 = 100, \quad \frac{S}{2} = 50$$
$$E = 55 > 50$$

- 先分配: $(45, 2.5, 1.5, 1)$，总共50
- 剩余: 5

CEL在 $(45, 2.5, 1.5, 1)$ 上分配5:
- $(45-\mu) = 5$
- $\mu = 40$

最终:
$$x_1 = 45 + 5 = 50$$
$$x_2 = 2.5, \quad x_3 = 1.5, \quad x_4 = 1$$

**结果:** $[50, 2.5, 1.5, 1]$ ✓

---

### E=60, Claims=[90, 5, 3, 2]

- 先分配: 50
- 剩余: 10

CEL:
- $(45-\mu) = 10$
- $\mu = 35$

最终:
$$x_1 = 55, \quad x_2 = 2.5, \quad x_3 = 1.5, \quad x_4 = 1$$

**结果:** $[55, 2.5, 1.5, 1]$ ✓

---

### E=65, Claims=[90, 5, 3, 2]

- 先分配: 50
- 剩余: 15

CEL:
- $(45-\mu) = 15$
- $\mu = 30$

最终:
$$x_1 = 60, \quad x_2 = 2.5, \quad x_3 = 1.5, \quad x_4 = 1$$

**结果:** $[60, 2.5, 1.5, 1]$ ✓

---

### E=55, Claims=[1, 33, 33, 33]

$$S = 100, \quad \frac{S}{2} = 50$$

- 先分配: $(0.5, 16.5, 16.5, 16.5)$，总共50
- 剩余: 5

CEL在 $(0.5, 16.5, 16.5, 16.5)$ 上分配5:
- $3(16.5 - \mu) = 5$
- $\mu = 16.5 - \frac{5}{3} = \frac{44.5}{3} \approx 14.8333$

最终:
$$x_1 = 0.5$$
$$x_2 = x_3 = x_4 = 16.5 + \frac{5}{3} = 16.5 + 1.6667 = 18.1667$$

**结果:** $[0.5, 18.17, 18.17, 18.17]$ ✓

---

### E=60, Claims=[1, 33, 33, 33]

- 先分配: $(0.5, 16.5, 16.5, 16.5)$
- 剩余: 10

CEL:
- $3(16.5 - \mu) = 10$
- $\mu = 16.5 - \frac{10}{3} = \frac{39.5}{3} \approx 13.1667$

最终:
$$x_1 = 0.5$$
$$x_2 = x_3 = x_4 = 16.5 + \frac{10}{3} = 19.8333$$

**结果:** $[0.5, 19.83, 19.83, 19.83]$ ✓

---

### E=65, Claims=[1, 33, 33, 33]

- 先分配: $(0.5, 16.5, 16.5, 16.5)$
- 剩余: 15

CEL:
- $3(16.5 - \mu) = 15$
- $\mu = 11.5$

最终:
$$x_1 = 0.5$$
$$x_2 = x_3 = x_4 = 16.5 + 5 = 21.5$$

**结果:** $[0.5, 21.5, 21.5, 21.5]$ ✓

---

### E=55/60/65, Claims=[70, 10, 10, 10]

已在前面验证 ✓

---

## 总结

**所有计算结果均与给定答案一致！**

验证了24个独立的计算案例，CG-CEL算法实现正确。
